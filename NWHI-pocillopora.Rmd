---
title: "NWHI-pocillopora"
author: "CB Wall"
date: "08/21/2024"
output:
  html_document:
    code_folding: hide
    toc: yes
    toc_depth: 4
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '4'
editor_options: 
  chunk_output_type: console
---

## Project Overview


```{r setup chunk, setup, include = FALSE, cache=FALSE, message=FALSE, warning=FALSE, collapse=TRUE}
if (!require('knitr')) install.packages('knitr'); library('knitr')
knitr::opts_chunk$set(warning=FALSE, message=FALSE, fig.align='center')

# load packages
if (!require("pacman")) install.packages("pacman") # for rapid install if not in library

# use pacman to load all the packages you are missing!
pacman::p_load('knitr', 'lme4', 'lmerTest', 'tidyverse', 'effects', 'plyr', 'dplyr', 'plotrix', 'car',"gridExtra", "cowplot", "tools", "mgcv", "gratia", "MASS", "stats", "tidymv", "sjstats", "coin", "emmeans", "ggplot2", "mda", "nortest", "reshape2", "gmm", "propagate","ggmap", "RgoogleMaps", "MixSIAR","GGally", "ggbiplot", "ggcorrplot", "vegan", "pairwiseAdonis")


### general formatting for figures 
Fig.formatting<-(theme_classic()) +
  theme(text=element_text(size=10),
        axis.line=element_blank(),
        legend.text.align = 0,
        legend.text=element_text(size=10),
        #legend.title = element_blank(),
        panel.border = element_rect(fill=NA, colour = "black", linewidth =1),
        aspect.ratio=1, 
        axis.ticks.length=unit(0.25, "cm"),
        axis.text.y=element_text(
          margin=unit(c(0.5, 0.5, 0.5, 0.5), "cm"), colour="black", size=10), 
        axis.text.x=element_text(
          margin=unit(c(0.5, 0.5, 0.5, 0.5), "cm"), colour="black", size=8)) +
  theme(legend.key.size = unit(0.4, "cm")) +
  theme(aspect.ratio=1.3) +
  theme(panel.spacing=unit(c(0, 0, 0, 0), "cm"))

```

```{r}
# load in data
iso<-read.csv("data/isotope_data.csv")

iso<- iso %>% 
  dplyr::select(species, sample.ID, fraction, sample.run.ID, 
                ug.N, d15N, ug.C, d13C, d15N.h.s, d13C.h.s, C.N)

######### carbon

d13C<-ggplot(iso, aes(y=d13C, x=species))+
  facet_wrap(.~fraction)+
  geom_boxplot(fill="dodgerblue", alpha=0.9)+
  geom_jitter(color="blue", size=2, alpha=0.5) +
  ylab(expression(paste(delta^{13},C, " (\u2030)")))+
  ylim(-22, -12)+
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic")) +
  xlab("species")

d13C.HS<-ggplot(iso, aes(y=d13C.h.s, x=species))+
  geom_boxplot(fill="dodgerblue", alpha=0.9)+
  geom_jitter(color="blue", size=2, alpha=0.5) +
  ylab(expression(paste(delta^{13},C[H-S], " (\u2030)")))+
  ylim(-5, 1)+
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic")) +
  xlab("species")

############# nitrogen
d15N<-ggplot(iso, aes(y=d15N, x=species))+
  facet_wrap(.~fraction)+
  geom_boxplot(fill="mediumseagreen", alpha=0.9)+
  geom_jitter(color="olivedrab", size=2, alpha=0.5) +
  ylab(expression(paste(delta^{15},N, " (\u2030)")))+
  ylim(0, 5)+
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic")) +
  xlab("species")

d15N.HS<-ggplot(iso, aes(y=d15N.h.s, x=species))+
  geom_boxplot(fill="mediumseagreen", alpha=0.9)+
  geom_jitter(color="olivedrab", size=2, alpha=0.5) +
  ylab(expression(paste(delta^{15},N[H-S], " (\u2030)")))+
  ylim(0, 3)+
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic")) +
  xlab("species")

######## C.N
CN<-ggplot(iso, aes(y=C.N, x=species))+
  facet_wrap(.~fraction)+
  geom_boxplot(fill="coral", alpha=0.9)+
  geom_jitter(color="red", size=2, alpha=0.5) +
  ylab("C:N")+
  ylim(0, 15)+
  theme_bw() +
  theme(axis.text.x = element_text(face = "italic")) +
  xlab("species")


NWHI.coral<-plot_grid(d13C, d13C.HS, d15N, d15N.HS, nrow=2)
NWHI.coral
dev.copy(pdf, "figures/NWHI.coral.pdf", width = 10, height = 10, encod="MacRoman")
dev.off()
```

